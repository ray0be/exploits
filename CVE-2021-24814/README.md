# CVE-2021-24814

> Disclaimer: For educational purposes only.

This exploit provides a way to check if a Wordpress instance uses the
vulnerable plugin "wordpress-gdpr" in a vulnerable version (<1.9.26), and is
able to generate a pre-filled and working HTML file capable of uploading a
webshell to the remote Wordpress site.

As of today, works with the latest version of Wordpress (5.9.1).

The vulnerability related to CVE-2021-24814 is a reflected XSS via a POST request.
An attacker then have to trick an administrator into reaching a malicious HTML
page which will redirect the victim to the vulnerable endpoint and execute JS
code.

This exploit bypasses all the standard restrictions that exist on the vulnerable
endpoint and allows executing any JavaScript code on behalf of the tricked
administrator.

It focuses on uploading a webshell to an inconspicuous location, but it's
possible to replace the malicious code with anything else.

Requirements :
- the targeted WP must have installed the **wordpress-gdpr plugin** in version before 1.9.26 (version 1.9.26 is still vulnerable to XSS, but is less so, so allows less cool exploitation) ;
- the attacker must be able to send a message to an authenticated administrator (they must have a valid session cookie on the WP), and the victim must click on the link in this message (phishing / social engineering).

Note : in a real world exploitation scenario, we should obfuscate the JS code
to avoid the victim being able to understand what was executed if they
later investigate. Another idea is to set the redirect URL to a controlled
script that will delete the malicious page just after the exploitation is
successful.
